<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">

    <!-- FAVICONS / MANIFEST -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/web-app-manifest-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/web-app-manifest-512x512.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Trailing Drawdown Simulator | Grizzly Parrot Trading</title>
    <meta name="description" content="Simulate trailing drawdown rules on a sequence of trades. See exactly when a prop firm account would have blown up, with a visual equity vs. trail chart.">
    <meta name="robots" content="index, follow">

    <!-- Canonical -->
    <link rel="canonical" href="https://grizzlyparrottrading.com/tools/trailing-drawdown-simulator.html">

    <!-- Open Graph -->
    <meta property="og:title" content="Trailing Drawdown Simulator | Grizzly Parrot Trading">
    <meta property="og:description" content="Plug in a trade sequence and trailing amount to see when a prop firm trailing drawdown would tag you out, with a clear chart.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://grizzlyparrottrading.com/tools/trailing-drawdown-simulator.html">
    <meta property="og:site_name" content="Grizzly Parrot Trading">
    <meta property="og:image" content="https://grizzlyparrottrading.com/og-default.png">
    <meta property="og:image:width" content="1792">
    <meta property="og:image:height" content="941">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://grizzlyparrottrading.com/og-default.png">
    <meta name="twitter:title" content="Trailing Drawdown Simulator | Grizzly Parrot Trading">
    <meta name="twitter:description" content="Trailing drawdown simulator for futures prop firm style accounts, with a visual equity vs. trail graph.">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JMJVR3G5YN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-JMJVR3G5YN');
    </script>

    <link rel="stylesheet" href="../style.css">

</head>

<body>
    <!-- HEADER -->
    <header class="site-header">
        <div class="container header-inner">
            <div class="logo">
                <span class="logo-mark">GP</span>
                <span class="logo-text">Grizzly Parrot Trading</span>
            </div>
            <nav class="main-nav">
                
              <a href="../futures-basics/index.html">Futures Basics</a>
              <a href="../prop-firm-trading/index.html">Prop Firms</a>
              <a href="../platforms-tutorials/index.html">Platforms</a>
              <a href="../market-basics/index.html">Market Basics</a>
              <a href="../tools/index.html">Tools</a>
            </nav>
        </div>
    </header>

    <main>
        <!-- HERO -->
        <section class="hero">
            <div class="container hero-inner">
                <div class="hero-text">
                    <h1>Trailing Drawdown Simulator</h1>
                    <p>
                        Drop in a sequence of trades and a trailing drawdown amount. This shows you exactly where a 
                        prop-style trailing drawdown would have blown the account, instead of guessing.
                    </p>
                </div>
            </div>
        </section>

        <!-- TOOL SECTION -->
        <section class="section">
            <div class="container">
                <h2>Inputs</h2>

                <!-- OPTIONAL AD SLOT ABOVE TOOL -->
                <!-- <div class="ad-slot ad-top">Your ad code here</div> -->

                <div class="tool-grid">
                    <div class="tool-block">
                        <label for="td-start-balance">Starting Balance ($)</label>
                        <input type="number" id="td-start-balance" step="1" min="0" placeholder="e.g. 50000">
                    </div>

                    <div class="tool-block">
                        <label for="td-trail-amount">Trailing Drawdown Amount ($)</label>
                        <input type="number" id="td-trail-amount" step="1" min="0" placeholder="e.g. 2500">
                    </div>

                    <div class="tool-block">
                        <label>Trailing Style</label>
                        <div class="tool-inline">
                            <label>
                                <input type="radio" name="td-style" value="full" checked>
                                Always trails equity (classic trailing)
                            </label>
                        </div>
                        <div class="tool-inline">
                            <label>
                                <input type="radio" name="td-style" value="apex">
                                Trails equity but stops at starting balance (Apex-style cap)
                            </label>
                        </div>
                    </div>

                    <div class="tool-block">
                        <label for="td-trades">Trade P/L Sequence ($ per trade)</label>
                        <p class="field-help">
                            One trade per line. Use signed dollar values, e.g.:
                            <br>
                            <code>+250</code><br>
                            <code>-125</code><br>
                            <code>+400</code>
                        </p>
                        <textarea id="td-trades" rows="10" placeholder="+250
-125
+400
-300
+150"></textarea>
                    </div>

                    <div class="tool-block">
                      <div class="tool-actions">
                        <button id="td-calc-button" class="button-primary">Run Simulation</button>

                        <div class="tool-actions-secondary">
                          <button id="td-copy-link" class="button-secondary" type="button">Copy Share Link</button>
                          <button id="td-load-example" class="button-secondary" type="button">Load Example</button>
                          <span id="td-copy-status" class="tool-status" aria-live="polite"></span>
                        </div>
                      </div>
                    </div>


                      
                    </div>

                </div>
            </div>
        </section>

        <!-- RESULTS SECTION -->
        <section class="section section-alt">
            <div class="container">
                <h2>Results</h2>
                <div id="td-results-summary" class="results-box">
                    <p>Enter inputs and click Run Simulation.</p>
                </div>

                <div id="td-chart-container" class="results-box td-chart-container">
                    <h3>Equity Vs Trailing Drawdown</h3>
                    <canvas id="td-chart" height="260"></canvas>
                    <p class="chart-legend">
                        <span class="legend-item legend-equity">Equity</span>
                        <span class="legend-item legend-trail">Trailing Line</span>
                        <span class="legend-item legend-breach">Breach Point</span>
                    </p>
                </div>

                <div id="td-results-table-wrapper" class="results-box" style="margin-top: 20px; overflow-x:auto;">
                    <!-- Table gets injected here -->
                </div>

                <!-- OPTIONAL AD SLOT BELOW TOOL -->
                <!-- <div class="ad-slot ad-bottom">Your ad code here</div> -->
            </div>
        </section>

        <!-- EXPLANATION -->
        <section class="section">
            <div class="container">
                <h2>How This Simulator Treats Trailing Drawdown</h2>
                <div class="grid grid-3">
                    <article class="card">
                        <h3>Starting Line</h3>
                        <p>
                            The liquidation line starts at <strong>starting balance - trailing amount</strong>.
                            If your equity ever drops below that line, the account is considered blown.
                        </p>
                    </article>
                    <article class="card">
                        <h3>Trailing Logic</h3>
                        <p>
                            After each trade, the high-water mark (max equity) is updated. The trailing line is set to
                            <strong>high-water mark - trailing amount</strong>, subject to the cap rule you choose.
                        </p>
                    </article>
                    <article class="card">
                        <h3>Apex-Style Cap</h3>
                        <p>
                            In Apex mode, the trailing line never moves above the starting balance. Once your high-water
                            mark is high enough, the line stops climbing and effectively becomes a fixed max drawdown.
                        </p>
                    </article>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="site-footer">
        <div class="container footer-inner">
            <p>&copy; <span id="td-year"></span> Grizzly Parrot Trading. All rights reserved.</p>
            <div class="footer-links">
                <a href="/about.html">About</a>
                <a href="/disclaimer.html">Disclaimer</a>
                <a href="/privacy.html">Privacy</a>
                <a href="/contact.html">Contact</a>
                <a href="https://grizzlyparrottrading.com/books/probabilistic-execution/"  target="_blank">
                    Probabilistic Execution â€“ Free 3-Phase Trading Routine
                </a>
            </div>
        </div>
        <script>
            document.getElementById("td-year").textContent = new Date().getFullYear();
        </script>
    </footer>

    <!-- TOOL SCRIPT -->
    <script>
      const tdStartBalanceEl = document.getElementById("td-start-balance");
      const tdTrailAmountEl = document.getElementById("td-trail-amount");
      const tdTradesEl = document.getElementById("td-trades");
      const tdResultsSummary = document.getElementById("td-results-summary");
      const tdResultsTableWrapper = document.getElementById("td-results-table-wrapper");
      const tdCalcButton = document.getElementById("td-calc-button");
      const tdChartCanvas = document.getElementById("td-chart");
      const tdChartContainer = document.getElementById("td-chart-container");
      const tdCopyLinkBtn = document.getElementById("td-copy-link");
      const tdLoadExampleBtn = document.getElementById("td-load-example");
      const tdCopyStatus = document.getElementById("td-copy-status");

      function tdFormat(num, decimals) {
        return Number(num).toFixed(decimals);
      }

      function parseTrades(raw) {
        return raw
          .split(/\r?\n/)
          .map(line => line.trim())
          .filter(line => line.length > 0)
          .map(line => {
            const cleaned = line.replace(/,/g, "");
            const value = parseFloat(cleaned);
            return isNaN(value) ? null : value;
          })
          .filter(v => v !== null);
      }

      function drawTdChart(rows, startBalance, initialTrail, blownTradeIndex) {
        const canvas = tdChartCanvas;
        const container = tdChartContainer;
        const ctx = canvas.getContext("2d");

        if (!rows || rows.length === 0) {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          return;
        }

        // Responsive width
        const rect = container.getBoundingClientRect();
        canvas.width = Math.max(320, rect.width - 40);

        const width = canvas.width;
        const height = canvas.height;

        ctx.clearRect(0, 0, width, height);

        // Collect Y values
        let minY = startBalance;
        let maxY = startBalance;

        rows.forEach(r => {
          if (r.equityAfter < minY) minY = r.equityAfter;
          if (r.trailLine < minY) minY = r.trailLine;
          if (r.equityAfter > maxY) maxY = r.equityAfter;
          if (r.trailLine > maxY) maxY = r.trailLine;
        });

        if (initialTrail < minY) minY = initialTrail;
        if (initialTrail > maxY) maxY = initialTrail;

        // Avoid zero-range
        if (maxY === minY) {
          maxY += 1;
          minY -= 1;
        }

        const paddingLeft = 40;
        const paddingRight = 10;
        const paddingTop = 10;
        const paddingBottom = 30;

        const plotWidth = width - paddingLeft - paddingRight;
        const plotHeight = height - paddingTop - paddingBottom;

        function yToPx(value) {
          const ratio = (value - minY) / (maxY - minY);
          return paddingTop + (1 - ratio) * plotHeight;
        }

        function xToPx(index) {
          if (rows.length === 1) return paddingLeft + plotWidth / 2;
          const ratio = index / (rows.length - 1);
          return paddingLeft + ratio * plotWidth;
        }

        // Gridlines (simple)
        ctx.strokeStyle = "#e2e8f0";
        ctx.lineWidth = 1;
        ctx.beginPath();
        // horizontal mid-line
        const midYVal = (minY + maxY) / 2;
        const midY = yToPx(midYVal);
        ctx.moveTo(paddingLeft, midY);
        ctx.lineTo(width - paddingRight, midY);
        ctx.stroke();

        // Y-axis labels
        ctx.fillStyle = "#1a202c";
        ctx.font = "11px system-ui, -apple-system, BlinkMacSystemFont, sans-serif";
        ctx.textAlign = "right";
        ctx.textBaseline = "middle";
        ctx.fillText("$" + tdFormat(maxY, 0), paddingLeft - 4, yToPx(maxY));
        ctx.fillText("$" + tdFormat(midYVal, 0), paddingLeft - 4, midY);
        ctx.fillText("$" + tdFormat(minY, 0), paddingLeft - 4, yToPx(minY));

        // X-axis labels (first, last)
        ctx.textAlign = "center";
        ctx.textBaseline = "top";
        const xFirst = xToPx(0);
        const xLast = xToPx(rows.length - 1);
        ctx.fillText("1", xFirst, height - paddingBottom + 4);
        ctx.fillText(String(rows.length), xLast, height - paddingBottom + 4);

        // Draw equity line
        ctx.strokeStyle = "#0a7cff"; // blue-ish
        ctx.lineWidth = 2;
        ctx.beginPath();
        rows.forEach((r, idx) => {
          const x = xToPx(idx);
          const y = yToPx(r.equityAfter);
          if (idx === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        });
        ctx.stroke();

        // Draw trail line
        ctx.strokeStyle = "#e53e3e"; // red-ish
        ctx.lineWidth = 2;
        ctx.beginPath();
        rows.forEach((r, idx) => {
          const x = xToPx(idx);
          const y = yToPx(r.trailLine);
          if (idx === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        });
        ctx.stroke();

        // Mark breach point if any
        if (blownTradeIndex !== null) {
          const breachIdx = blownTradeIndex - 1;
          if (breachIdx >= 0 && breachIdx < rows.length) {
            const breachRow = rows[breachIdx];
            const x = xToPx(breachIdx);
            const y = yToPx(breachRow.equityAfter);

            ctx.fillStyle = "#c53030";
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, Math.PI * 2);
            ctx.fill();
          }
        }
      }

      tdCalcButton.addEventListener("click", function () {
        const startBalance = parseFloat(tdStartBalanceEl.value);
        const trailAmount = parseFloat(tdTrailAmountEl.value);
        const trades = parseTrades(tdTradesEl.value);
        const style = document.querySelector('input[name="td-style"]:checked').value;

        if (isNaN(startBalance) || startBalance <= 0) {
          tdResultsSummary.innerHTML = "<p>Enter a valid starting balance above 0.</p>";
          tdResultsTableWrapper.innerHTML = "";
          drawTdChart([], 0, 0, null);
          return;
        }

        if (isNaN(trailAmount) || trailAmount <= 0) {
          tdResultsSummary.innerHTML = "<p>Enter a valid trailing drawdown amount above 0.</p>";
          tdResultsTableWrapper.innerHTML = "";
          drawTdChart([], 0, 0, null);
          return;
        }

        if (trades.length === 0) {
          tdResultsSummary.innerHTML = "<p>Enter at least one trade P/L.</p>";
          tdResultsTableWrapper.innerHTML = "";
          drawTdChart([], 0, 0, null);
          return;
        }

        let equity = startBalance;
        let highWater = startBalance;
        let trailLine = startBalance - trailAmount;
        const initialTrail = trailLine;
        let blown = false;
        let blownTradeIndex = null;

        const rows = [];

        trades.forEach((pl, idx) => {
          const tradeNum = idx + 1;
          const equityBefore = equity;

          equity += pl;
          if (equity > highWater) {
            highWater = equity;
          }

          let newTrail = highWater - trailAmount;

          if (style === "apex") {
            newTrail = Math.min(newTrail, startBalance);
          }

          trailLine = newTrail;

          const breach = equity < trailLine;

          if (!blown && breach) {
            blown = true;
            blownTradeIndex = tradeNum;
          }

          rows.push({
            tradeNum,
            pl,
            equityBefore,
            equityAfter: equity,
            highWater,
            trailLine,
            breach
          });
        });

        if (blown) {
          tdResultsSummary.innerHTML = `
            <p>
              Account <strong>would have violated trailing drawdown</strong> on trade 
              <strong>#${blownTradeIndex}</strong>.
            </p>
            <p>
              Final equity: <strong>$${tdFormat(equity, 2)}</strong> |
              Final trail line: <strong>$${tdFormat(trailLine, 2)}</strong>
            </p>
          `;
        } else {
          tdResultsSummary.innerHTML = `
            <p>
              Account <strong>does not violate trailing drawdown</strong> on this trade sequence.
            </p>
            <p>
              Final equity: <strong>$${tdFormat(equity, 2)}</strong> |
              Final trail line: <strong>$${tdFormat(trailLine, 2)}</strong>
            </p>
          `;
        }

        // Build table
        let html = `
          <table class="results-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Trade P/L ($)</th>
                <th>Equity Before ($)</th>
                <th>Equity After ($)</th>
                <th>High-Water ($)</th>
                <th>Trail Line ($)</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
        `;

        rows.forEach(row => {
          const status = row.breach ? "BREACH" : "OK";
          const rowClass = row.breach ? "breach-row" : "";
          html += `
            <tr class="${rowClass}">
              <td>${row.tradeNum}</td>
              <td>${tdFormat(row.pl, 2)}</td>
              <td>${tdFormat(row.equityBefore, 2)}</td>
              <td>${tdFormat(row.equityAfter, 2)}</td>
              <td>${tdFormat(row.highWater, 2)}</td>
              <td>${tdFormat(row.trailLine, 2)}</td>
              <td>${status}</td>
            </tr>
          `;
        });

        html += `
            </tbody>
          </table>
        `;

        tdResultsTableWrapper.innerHTML = html;

        // Draw chart
        drawTdChart(rows, startBalance, initialTrail, blownTradeIndex);
      });
      function tdSetStatus(msg) {
  tdCopyStatus.textContent = msg;
  setTimeout(function () {
    tdCopyStatus.textContent = "";
  }, 3000);
}

function tdBuildShareUrl() {
  const startBalance = tdStartBalanceEl.value.trim();
  const trailAmount = tdTrailAmountEl.value.trim();
  const style = document.querySelector('input[name="td-style"]:checked').value;
  const tradesRaw = tdTradesEl.value.trim();

  const params = new URLSearchParams();

  if (startBalance) params.set("bal", startBalance);
  if (trailAmount) params.set("trail", trailAmount);
  if (style) params.set("style", style);

  if (tradesRaw) {
    const trades = parseTrades(tradesRaw);
    if (trades.length > 0) {
      params.set("trades", trades.join(","));
    }
  }

  const base = window.location.origin + window.location.pathname;
  return base + "?" + params.toString();
}

function tdApplyFromUrl() {
  const params = new URLSearchParams(window.location.search);

  const bal = params.get("bal");
  const trail = params.get("trail");
  const style = params.get("style");
  const trades = params.get("trades");

  if (bal) tdStartBalanceEl.value = bal;
  if (trail) tdTrailAmountEl.value = trail;

  if (style === "full" || style === "apex") {
    const radio = document.querySelector('input[name="td-style"][value="' + style + '"]');
    if (radio) radio.checked = true;
  }

  if (trades) {
    const lines = trades
      .split(",")
      .map(function (s) { return s.trim(); })
      .filter(function (v) { return v.length > 0; });

    tdTradesEl.value = lines.join("\n");
  }
}

async function tdCopyToClipboard(text) {
  try {
    await navigator.clipboard.writeText(text);
    return true;
  } catch (e) {
    const ta = document.createElement("textarea");
    ta.value = text;
    ta.style.position = "fixed";
    ta.style.left = "-9999px";
    document.body.appendChild(ta);
    ta.select();
    let ok = false;
    try {
      ok = document.execCommand("copy");
    } catch (e2) {
      ok = false;
    }
    document.body.removeChild(ta);
    return ok;
  }
}

if (tdCopyLinkBtn) {
  tdCopyLinkBtn.addEventListener("click", async function () {
    const url = tdBuildShareUrl();
    const ok = await tdCopyToClipboard(url);
    tdSetStatus(ok ? "Share link copied." : "Could not copy link.");
  });
}

if (tdLoadExampleBtn) {
  tdLoadExampleBtn.addEventListener("click", function () {
    tdStartBalanceEl.value = "50000";
    tdTrailAmountEl.value = "2500";
    const apexRadio = document.querySelector('input[name="td-style"][value="apex"]');
    if (apexRadio) apexRadio.checked = true;

    tdTradesEl.value = "+500\n-600\n+700\n-900\n+400\n-1200\n+300";
    tdSetStatus("Example loaded. Click Run Simulation.");
  });
}

tdApplyFromUrl();

    </script>

    <style>
      .results-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
      }
      .results-table th,
      .results-table td {
        border: 1px solid #e2e8f0;
        padding: 6px 8px;
        text-align: right;
      }
      .results-table th:first-child,
      .results-table td:first-child {
        text-align: center;
      }
      .results-table th {
        background: #0a3764;
        color: #ffffff;
      }
      .breach-row {
        background: #ffe5e5;
      }
      .field-help {
        font-size: 13px;
        color: #4a5568;
        margin-bottom: 6px;
      }
      textarea#td-trades {
        width: 100%;
        font-family: monospace;
        padding: 8px;
        resize: vertical;
      }
      .td-chart-container {
        margin-top: 20px;
      }
      #td-chart {
        width: 100%;
        max-width: 100%;
        border: 1px solid #e2e8f0;
        background: #ffffff;
        display: block;
      }
      .chart-legend {
        margin-top: 8px;
        font-size: 12px;
      }
      .legend-item {
        display: inline-block;
        margin-right: 12px;
        padding-left: 16px;
        position: relative;
      }
      .legend-item::before {
        content: "";
        position: absolute;
        left: 0;
        top: 50%;
        width: 10px;
        height: 2px;
        transform: translateY(-50%);
      }
      .legend-equity::before {
        background: #0a7cff;
      }
      .legend-trail::before {
        background: #e53e3e;
      }
      .legend-breach::before {
        background: #c53030;
        height: 8px;
        width: 8px;
        border-radius: 50%;
      }
    </style>

    <!-- SERVICE WORKER -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          // ("/sw.js").catch(function () {});
        });
      }
    </script>
</body>
</html>
