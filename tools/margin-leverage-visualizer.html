<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- FAVICONS / MANIFEST -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/web-app-manifest-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/web-app-manifest-512x512.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Futures Margin &amp; Leverage Visualizer | Grizzly Parrot Trading</title>
    <meta name="description" content="See real futures leverage, margin usage, and P/L as % of your account for a move in price. Pick a contract, set account size and margin, and drag the slider.">
    <meta name="robots" content="index, follow">

    <!-- Canonical -->
    <link rel="canonical" href="https://grizzlyparrottrading.com/margin-leverage-visualizer.html">

    <!-- Open Graph -->
    <meta property="og:title" content="Futures Margin &amp; Leverage Visualizer | Grizzly Parrot Trading">
    <meta property="og:description" content="Interactive futures margin and leverage tool with a simple risk bar: how much of your account you’re putting on the line.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://grizzlyparrottrading.com/margin-leverage-visualizer.html">
    <meta property="og:site_name" content="Grizzly Parrot Trading">
    <meta property="og:image" content="https://grizzlyparrottrading.com/og-default.png">
    <meta property="og:image:width" content="1792">
    <meta property="og:image:height" content="941">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://grizzlyparrottrading.com/og-default.png">
    <meta name="twitter:title" content="Futures Margin &amp; Leverage Visualizer | Grizzly Parrot Trading">
    <meta name="twitter:description" content="Check real leverage, margin usage, and account risk for a given move in price.">

    <!-- Google tag (Analytics) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JMJVR3G5YN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-JMJVR3G5YN');
    </script>

    <link rel="stylesheet" href="../style.css">
</head>

<body>
<header class="site-header">
    <div class="container header-inner">
        <div class="logo">
            <span class="logo-mark">GP</span>
            <span class="logo-text">Grizzly Parrot Trading</span>
        </div>
        <nav class="main-nav">
            <a href="/app.html" id="get-app-link">Get the App</a>
            <a href="futures-basics/index.html">Futures Basics</a>
            <a href="prop-firm-trading/index.html">Prop Firms</a>
            <a href="platforms-tutorials/index.html">Platforms</a>
            <a href="market-basics/index.html">Market Basics</a>
        </nav>
    </div>
</header>

<main>
    <section class="hero">
        <div class="container hero-inner">
            <div class="hero-text">
                <h1>Futures Margin &amp; Leverage Visualizer</h1>
                <p>
                    Pick a contract, plug in your account size and margin, and drag the slider.
                    You’ll see how much notional you’re swinging, how much margin you’re locking up,
                    and how much of your account gets torched if price moves.
                </p>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <h2>Inputs</h2>

            <div class="tool-grid">
                <div class="tool-block">
                    <label for="ml-symbol">Contract</label>
                    <select id="ml-symbol">
                        <!-- Index futures -->
                        <option value="ES">ES (E-mini S&amp;P 500)</option>
                        <option value="MES">MES (Micro E-mini S&amp;P 500)</option>
                        <option value="NQ">NQ (E-mini Nasdaq-100)</option>
                        <option value="MNQ">MNQ (Micro E-mini Nasdaq-100)</option>
                        <option value="YM">YM (E-mini Dow)</option>
                        <option value="MYM">MYM (Micro E-mini Dow)</option>
                        <option value="RTY">RTY (E-mini Russell 2000)</option>
                        <option value="M2K">M2K (Micro E-mini Russell 2000)</option>

                        <!-- FX majors -->
                        <option value="6E">6E (Euro FX)</option>
                        <option value="6B">6B (British Pound)</option>
                        <option value="6J">6J (Japanese Yen)</option>
                        <option value="6A">6A (Australian Dollar)</option>
                        <option value="6C">6C (Canadian Dollar)</option>
                        <option value="6S">6S (Swiss Franc)</option>
                        <option value="6N">6N (New Zealand Dollar)</option>
                        <option value="6M">6M (Mexican Peso)</option>

                        <!-- Metals -->
                        <option value="GC">GC (Gold)</option>
                        <option value="MGC">MGC (Micro Gold)</option>
                        <option value="SI">SI (Silver)</option>
                        <option value="HG">HG (Copper)</option>
                        <option value="PL">PL (Platinum)</option>
                        <option value="PA">PA (Palladium)</option>

                        <!-- Energies -->
                        <option value="CL">CL (Crude Oil)</option>
                        <option value="MCL">MCL (Micro Crude Oil)</option>
                        <option value="QM">QM (E-mini Crude Oil)</option>
                        <option value="NG">NG (Natural Gas)</option>
                        <option value="QG">QG (E-mini Natural Gas)</option>
                        <option value="RB">RB (RBOB Gasoline)</option>
                        <option value="HO">HO (Heating Oil)</option>

                        <!-- Grains / oilseeds -->
                        <option value="ZC">ZC (Corn)</option>
                        <option value="ZS">ZS (Soybeans)</option>
                        <option value="ZW">ZW (Wheat)</option>
                        <option value="ZL">ZL (Soybean Oil)</option>
                        <option value="ZM">ZM (Soybean Meal)</option>
                        <option value="KE">KE (KC Wheat)</option>
                        <option value="O">O (Oats)</option>

                        <!-- Softs -->
                        <option value="KC">KC (Coffee)</option>
                        <option value="SB">SB (Sugar No. 11)</option>
                        <option value="CT">CT (Cotton)</option>
                        <option value="CC">CC (Cocoa)</option>
                        <option value="OJ">OJ (Orange Juice)</option>

                        <!-- Livestock -->
                        <option value="LE">LE (Live Cattle)</option>
                        <option value="HE">HE (Lean Hogs)</option>
                        <option value="GF">GF (Feeder Cattle)</option>

                        <!-- Rates -->
                        <option value="ZT">ZT (2-Year T-Note)</option>
                        <option value="ZF">ZF (5-Year T-Note)</option>
                        <option value="ZN">ZN (10-Year T-Note)</option>
                        <option value="ZB">ZB (30-Year T-Bond)</option>
                        <option value="UB">UB (Ultra T-Bond)</option>
                        <option value="SR3">SR3 (3-Month SOFR)</option>
                    </select>
                </div>

                <div class="tool-block">
                    <label for="ml-account">Account Size ($)</label>
                    <input type="number" id="ml-account" min="0" step="1" placeholder="e.g. 2500">
                </div>

                <div class="tool-block">
                    <label for="ml-price">Current Futures Price</label>
                    <input type="number" id="ml-price" min="0" step="0.0001" placeholder="e.g. 5300.00 or 1.1050 or 5.25">
                    <p class="field-help">
                        Use the same price format your platform shows.<br>
                        Index / metals / energies: 5300.00, 78.25, 2450.4 etc.<br>
                        FX (6E, 6B, etc.): 1.1050, 0.7500, etc.<br>
                        Grains / softs: dollars per unit (5.25 for ZC, 0.85 for ZL, 190.00 for KC, etc.).
                    </p>
                </div>

                <div class="tool-block">
                    <label for="ml-contracts">Contracts</label>
                    <input type="number" id="ml-contracts" min="1" step="1" placeholder="e.g. 1">
                </div>

                <div class="tool-block">
                    <label for="ml-margin-intra">Intraday Margin / Contract ($)</label>
                    <input type="number" id="ml-margin-intra" min="0" step="1" placeholder="e.g. 500">
                </div>

                <div class="tool-block">
                    <label for="ml-margin-overnight">Overnight Margin / Contract ($)</label>
                    <input type="number" id="ml-margin-overnight" min="0" step="1" placeholder="e.g. 13200">
                </div>

                <div class="tool-block">
                    <label>Margin Mode</label>
                    <div class="tool-inline">
                        <label><input type="radio" name="ml-margin-mode" value="intra" checked> Intraday</label>
                        <label><input type="radio" name="ml-margin-mode" value="overnight"> Overnight</label>
                    </div>
                </div>

                <div class="tool-block">
                    <label for="ml-move-points">Price Move (points)</label>
                    <div class="ml-slider-row">
                        <input type="range" id="ml-move-points" min="-50" max="50" step="0.25" value="5">
                        <input type="number" id="ml-move-points-number" step="0.25" value="5">
                    </div>
                    <p class="field-help">
                        Positive = move in your favor. Negative = against you.
                        This is in price units, not ticks.
                    </p>
                </div>

                <div class="tool-block">
                    <button id="ml-calc-btn" class="button-primary">Recalculate</button>
                </div>
            </div>
        </div>
    </section>

    <section class="section section-alt">
        <div class="container">
            <h2>Results</h2>
            <div id="ml-results-summary" class="results-box">
                <p>Fill out the inputs and move the slider.</p>
            </div>
            <div id="ml-results-detail" class="results-box" style="margin-top: 20px;">
                <!-- details injected here -->
            </div>

            <div class="results-chart-wrapper">
                <h3>Risk On This Move (% of Account)</h3>
                <div class="risk-bar-outer">
                    <div id="ml-risk-bar-inner"></div>
                </div>
                <p id="ml-risk-label" class="field-help">
                    Adjust the slider to see how much of your account this move puts at risk.
                </p>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <h2>How To Read This</h2>
            <div class="grid grid-3">
                <article class="card">
                    <h3>Notional &amp; Leverage</h3>
                    <p>
                        Notional = price × contract size × contracts.
                        Leverage = total notional ÷ your account.
                    </p>
                </article>
                <article class="card">
                    <h3>Margin Usage</h3>
                    <p>
                        Margin used = margin/contract × contracts.
                        Margin % tells you how much of your account is locked just to hold the position.
                    </p>
                </article>
                <article class="card">
                    <h3>Damage From A Move</h3>
                    <p>
                        The key number is “P/L as % of account.”
                        If a normal wiggle costs you 10–20% of the account,
                        you’re not “trading” — you’re begging to blow up.
                    </p>
                </article>
            </div>
        </div>
    </section>
</main>

<footer class="site-footer">
    <div class="container footer-inner">
        <p>&copy; <span id="ml-year"></span> Grizzly Parrot Trading. All rights reserved.</p>
        <div class="footer-links">
            <a href="about.html">About</a>
            <a href="disclaimer.html">Disclaimer</a>
            <a href="privacy.html">Privacy</a>
            <a href="contact.html">Contact</a>
            <a href="https://grizzlyparrottrading.com/books/probabilistic-execution/"  target="_blank">
                Probabilistic Execution – Free 3-Phase Trading Routine
            </a>
        </div>
    </div>
    <script>
        document.getElementById("ml-year").textContent = new Date().getFullYear();
    </script>
</footer>

<script>
// Contract specs: dollarPerPoint = P/L for a 1.00 move in price.
// multiplier = contract size for notional = price * multiplier.
const ML_CONTRACTS = {
  // INDEX FUTURES
  ES:  { name: "ES (E-mini S&P 500)",               dollarPerPoint: 50,       multiplier: 50 },
  MES: { name: "MES (Micro E-mini S&P 500)",        dollarPerPoint: 5,        multiplier: 5 },
  NQ:  { name: "NQ (E-mini Nasdaq-100)",            dollarPerPoint: 20,       multiplier: 20 },
  MNQ: { name: "MNQ (Micro E-mini Nasdaq-100)",     dollarPerPoint: 2,        multiplier: 2 },
  YM:  { name: "YM (E-mini Dow)",                   dollarPerPoint: 5,        multiplier: 5 },
  MYM: { name: "MYM (Micro E-mini Dow)",            dollarPerPoint: 0.5,      multiplier: 0.5 },
  RTY: { name: "RTY (E-mini Russell 2000)",         dollarPerPoint: 50,       multiplier: 50 },
  M2K: { name: "M2K (Micro E-mini Russell 2000)",   dollarPerPoint: 5,        multiplier: 5 },

  // FX MAJORS
  "6E": { name: "6E (Euro FX)",                     dollarPerPoint: 125000,   multiplier: 125000 },
  "6B": { name: "6B (British Pound)",               dollarPerPoint: 62500,    multiplier: 62500 },
  "6J": { name: "6J (Japanese Yen)",                dollarPerPoint: 12500000, multiplier: 12500000 },
  "6A": { name: "6A (Australian Dollar)",           dollarPerPoint: 100000,   multiplier: 100000 },
  "6C": { name: "6C (Canadian Dollar)",             dollarPerPoint: 100000,   multiplier: 100000 },
  "6S": { name: "6S (Swiss Franc)",                 dollarPerPoint: 125000,   multiplier: 125000 },
  "6N": { name: "6N (New Zealand Dollar)",          dollarPerPoint: 100000,   multiplier: 100000 },
  "6M": { name: "6M (Mexican Peso)",                dollarPerPoint: 500000,   multiplier: 500000 },

  // METALS
  GC:  { name: "GC (Gold)",                         dollarPerPoint: 100,      multiplier: 100 },
  MGC: { name: "MGC (Micro Gold)",                  dollarPerPoint: 10,       multiplier: 10 },
  SI:  { name: "SI (Silver)",                       dollarPerPoint: 5000,     multiplier: 5000 },
  HG:  { name: "HG (Copper)",                       dollarPerPoint: 25000,    multiplier: 25000 },
  PL:  { name: "PL (Platinum)",                     dollarPerPoint: 50,       multiplier: 50 },
  PA:  { name: "PA (Palladium)",                    dollarPerPoint: 100,      multiplier: 100 },

  // ENERGIES
  CL:  { name: "CL (Crude Oil)",                    dollarPerPoint: 1000,     multiplier: 1000 },
  MCL:{ name: "MCL (Micro Crude Oil)",              dollarPerPoint: 100,      multiplier: 100 },
  QM:  { name: "QM (E-mini Crude Oil)",             dollarPerPoint: 500,      multiplier: 500 },
  NG:  { name: "NG (Natural Gas)",                  dollarPerPoint: 10000,    multiplier: 10000 },
  QG:  { name: "QG (E-mini Natural Gas)",           dollarPerPoint: 2500,     multiplier: 2500 },
  RB:  { name: "RB (RBOB Gasoline)",                dollarPerPoint: 42000,    multiplier: 42000 },
  HO:  { name: "HO (Heating Oil)",                  dollarPerPoint: 42000,    multiplier: 42000 },

  // GRAINS / OILSEEDS
  ZC:  { name: "ZC (Corn)",                         dollarPerPoint: 5000,     multiplier: 5000 },
  ZS:  { name: "ZS (Soybeans)",                     dollarPerPoint: 5000,     multiplier: 5000 },
  ZW:  { name: "ZW (Wheat)",                        dollarPerPoint: 5000,     multiplier: 5000 },
  ZL:  { name: "ZL (Soybean Oil)",                  dollarPerPoint: 60000,    multiplier: 60000 },
  ZM:  { name: "ZM (Soybean Meal)",                 dollarPerPoint: 100,      multiplier: 100 },
  KE:  { name: "KE (KC Wheat)",                     dollarPerPoint: 5000,     multiplier: 5000 },
  O:   { name: "O (Oats)",                          dollarPerPoint: 5000,     multiplier: 5000 },

  // SOFTS
  KC:  { name: "KC (Coffee)",                       dollarPerPoint: 37500,    multiplier: 37500 },
  SB:  { name: "SB (Sugar No. 11)",                 dollarPerPoint: 112000,   multiplier: 112000 },
  CT:  { name: "CT (Cotton)",                       dollarPerPoint: 50000,    multiplier: 50000 },
  CC:  { name: "CC (Cocoa)",                        dollarPerPoint: 10,       multiplier: 10 },
  OJ:  { name: "OJ (Orange Juice)",                 dollarPerPoint: 15000,    multiplier: 15000 },

  // LIVESTOCK
  LE:  { name: "LE (Live Cattle)",                  dollarPerPoint: 40000,    multiplier: 40000 },
  HE:  { name: "HE (Lean Hogs)",                    dollarPerPoint: 40000,    multiplier: 40000 },
  GF:  { name: "GF (Feeder Cattle)",                dollarPerPoint: 50000,    multiplier: 50000 },

  // RATES
  ZT:  { name: "ZT (2-Year T-Note)",                dollarPerPoint: 2000,     multiplier: 2000 },
  ZF:  { name: "ZF (5-Year T-Note)",                dollarPerPoint: 1000,     multiplier: 1000 },
  ZN:  { name: "ZN (10-Year T-Note)",               dollarPerPoint: 1000,     multiplier: 1000 },
  ZB:  { name: "ZB (30-Year T-Bond)",               dollarPerPoint: 1000,     multiplier: 1000 },
  UB:  { name: "UB (Ultra T-Bond)",                 dollarPerPoint: 1000,     multiplier: 1000 },
  SR3:{ name: "SR3 (3-Month SOFR)",                 dollarPerPoint: 2500,     multiplier: 2500 }
};

function mlFmt(num, dec) {
  return Number(num).toFixed(dec);
}

const mlSymbolEl = document.getElementById("ml-symbol");
const mlAccountEl = document.getElementById("ml-account");
const mlPriceEl = document.getElementById("ml-price");
const mlContractsEl = document.getElementById("ml-contracts");
const mlMarginIntraEl = document.getElementById("ml-margin-intra");
const mlMarginOvernightEl = document.getElementById("ml-margin-overnight");
const mlMoveSliderEl = document.getElementById("ml-move-points");
const mlMoveNumberEl = document.getElementById("ml-move-points-number");
const mlCalcBtn = document.getElementById("ml-calc-btn");
const mlResultsSummary = document.getElementById("ml-results-summary");
const mlResultsDetail = document.getElementById("ml-results-detail");
const mlRiskBar = document.getElementById("ml-risk-bar-inner");
const mlRiskLabel = document.getElementById("ml-risk-label");

function resetRiskBar() {
  mlRiskBar.style.width = "0%";
  mlRiskBar.style.backgroundColor = "#0f172a";
  mlRiskLabel.textContent = "Adjust the slider to see how much of your account this move puts at risk.";
}

function updateRiskBar(movePLPct) {
  // Only downside counts as risk.
  const lossPct = movePLPct < 0 ? Math.abs(movePLPct) : 0;
  const capped = Math.min(lossPct, 100);

  mlRiskBar.style.width = capped + "%";

  let color, msg;

  if (lossPct === 0) {
    color = "#16a34a";
    msg = "Price move in your favor. Risk on this move: 0%.";
  } else if (lossPct < 0.5) {
    color = "#16a34a";
    msg = "Risk: " + mlFmt(lossPct, 2) + "% of account. Boring. This is fine.";
  } else if (lossPct < 1.5) {
    color = "#16a34a";
    msg = "Risk: " + mlFmt(lossPct, 2) + "% of account. Sensible sizing.";
  } else if (lossPct < 3) {
    color = "#facc15";
    msg = "Risk: " + mlFmt(lossPct, 2) + "% of account. Getting spicy, make sure the setup actually deserves it.";
  } else if (lossPct < 6) {
    color = "#f97316";
    msg = "Risk: " + mlFmt(lossPct, 2) + "% of account. This is heat. If this is a random click, you’re being stupid.";
  } else {
    color = "#dc2626";
    msg = "Risk: " + mlFmt(lossPct, 2) + "% of account. You’re one dumb move away from 'why is my account balance zero?'.";
  }

  mlRiskBar.style.backgroundColor = color;
  mlRiskLabel.textContent = msg;
}

function mlCompute() {
  const symbol = mlSymbolEl.value;
  const spec = ML_CONTRACTS[symbol];

  const account = parseFloat(mlAccountEl.value);
  const price = parseFloat(mlPriceEl.value);
  const contracts = parseFloat(mlContractsEl.value);
  const marginIntra = parseFloat(mlMarginIntraEl.value);
  const marginOvernight = parseFloat(mlMarginOvernightEl.value);
  const movePoints = parseFloat(mlMoveSliderEl.value);
  const marginMode = document.querySelector('input[name="ml-margin-mode"]:checked').value;

  if (!spec) {
    mlResultsSummary.innerHTML = "<p>Unknown contract spec.</p>";
    mlResultsDetail.innerHTML = "";
    resetRiskBar();
    return;
  }

  if (isNaN(account) || account <= 0) {
    mlResultsSummary.innerHTML = "<p>Enter a valid account size.</p>";
    mlResultsDetail.innerHTML = "";
    resetRiskBar();
    return;
  }

  if (isNaN(price) || price <= 0) {
    mlResultsSummary.innerHTML = "<p>Enter a valid current futures price.</p>";
    mlResultsDetail.innerHTML = "";
    resetRiskBar();
    return;
  }

  if (isNaN(contracts) || contracts <= 0) {
    mlResultsSummary.innerHTML = "<p>Enter a valid number of contracts.</p>";
    mlResultsDetail.innerHTML = "";
    resetRiskBar();
    return;
  }

  let marginPer;
  if (marginMode === "intra") {
    if (isNaN(marginIntra) || marginIntra <= 0) {
      mlResultsSummary.innerHTML = "<p>Enter intraday margin per contract or switch to overnight.</p>";
      mlResultsDetail.innerHTML = "";
      resetRiskBar();
      return;
    }
    marginPer = marginIntra;
  } else {
    if (isNaN(marginOvernight) || marginOvernight <= 0) {
      mlResultsSummary.innerHTML = "<p>Enter overnight margin per contract or switch to intraday.</p>";
      mlResultsDetail.innerHTML = "";
      resetRiskBar();
      return;
    }
    marginPer = marginOvernight;
  }

  const dollarPerPoint = spec.dollarPerPoint;
  const multiplier = spec.multiplier;

  const notionalPer = price * multiplier;
  const totalNotional = notionalPer * contracts;
  const leverage = totalNotional / account;

  const marginUsed = marginPer * contracts;
  const marginPct = (marginUsed / account) * 100;

  const plPerPointTotal = dollarPerPoint * contracts;
  const movePL = movePoints * plPerPointTotal;
  const movePLPct = (movePL / account) * 100;
  const equityAfterMove = account + movePL;

  mlResultsSummary.innerHTML = `
    <p>
      <strong>${spec.name}</strong> | ${contracts} contract(s) on a $${mlFmt(account, 0)} account at price ${mlFmt(price, 4)}.
    </p>
    <p>
      Total notional: <strong>$${mlFmt(totalNotional, 2)}</strong>
      &nbsp;|&nbsp; Leverage: <strong>${mlFmt(leverage, 1)}x</strong>
      &nbsp;|&nbsp; Margin used: <strong>$${mlFmt(marginUsed, 0)}</strong> (${mlFmt(marginPct, 1)}% of account)
    </p>
  `;

  mlResultsDetail.innerHTML = `
    <div class="results-grid">
      <div class="results-item">
        <h3>Contract Specs</h3>
        <p><strong>Dollar per 1.00 move in price:</strong> $${mlFmt(dollarPerPoint, 2)} per contract</p>
        <p><strong>Notional per contract:</strong> $${mlFmt(notionalPer, 2)}</p>
        <p><strong>Total notional:</strong> $${mlFmt(totalNotional, 2)}</p>
      </div>
      <div class="results-item">
        <h3>Margin Profile (${marginMode === "intra" ? "Intraday" : "Overnight"})</h3>
        <p><strong>Margin per contract:</strong> $${mlFmt(marginPer, 0)}</p>
        <p><strong>Total margin used:</strong> $${mlFmt(marginUsed, 0)}</p>
        <p><strong>Margin usage:</strong> ${mlFmt(marginPct, 1)}% of account</p>
      </div>
      <div class="results-item">
        <h3>P/L From Price Moves</h3>
        <p><strong>1.00 move in price:</strong> $${mlFmt(plPerPointTotal, 2)} (${mlFmt((plPerPointTotal / account) * 100, 2)}% of account)</p>
        <p><strong>${mlFmt(movePoints, 2)} move in price:</strong> $${mlFmt(movePL, 2)} (${mlFmt(movePLPct, 2)}% of account)</p>
        <p><strong>Equity after this move:</strong> $${mlFmt(equityAfterMove, 2)}</p>
      </div>
    </div>
  `;

  updateRiskBar(movePLPct);
}

// sync slider + live compute
mlMoveSliderEl.addEventListener("input", function () {
  mlMoveNumberEl.value = mlMoveSliderEl.value;
  mlCompute();
});

mlMoveNumberEl.addEventListener("input", function () {
  const v = parseFloat(mlMoveNumberEl.value);
  if (!isNaN(v) &&
      v >= parseFloat(mlMoveSliderEl.min) &&
      v <= parseFloat(mlMoveSliderEl.max)) {
    mlMoveSliderEl.value = v;
    mlCompute();
  }
});

// button = recompute
mlCalcBtn.addEventListener("click", mlCompute);

// recompute when key inputs change
["change", "blur"].forEach(function(evt) {
  mlSymbolEl.addEventListener(evt, mlCompute);
  mlAccountEl.addEventListener(evt, mlCompute);
  mlPriceEl.addEventListener(evt, mlCompute);
  mlContractsEl.addEventListener(evt, mlCompute);
  mlMarginIntraEl.addEventListener(evt, mlCompute);
  mlMarginOvernightEl.addEventListener(evt, mlCompute);
});
document.querySelectorAll('input[name="ml-margin-mode"]').forEach(function(r) {
  r.addEventListener("change", mlCompute);
});

resetRiskBar();
</script>

<script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", function () {
    navigator.serviceWorker.register("/sw.js").catch(function () {});
  });
}
</script>

<style>
.ml-slider-row {
  display: flex;
  gap: 10px;
  align-items: center;
}
.ml-slider-row input[type="range"] {
  flex: 1;
}
.ml-slider-row input[type="number"] {
  width: 90px;
}

/* Risk bar section styled for dark theme */
.results-chart-wrapper {
  margin-top: 24px;
  padding: 16px;
  background: #020617;          /* dark navy */
  border-radius: 8px;
  border: 1px solid #1f2937;
}
.results-chart-wrapper h3 {
  color: #e5e7eb;
  margin-top: 0;
  margin-bottom: 8px;
}
#ml-risk-label {
  color: #cbd5f5;
  opacity: 1;
}

.risk-bar-outer {
  width: 100%;
  height: 18px;
  border-radius: 999px;
  background: #0b1120;
  overflow: hidden;
}
#ml-risk-bar-inner {
  height: 100%;
  width: 0%;
  background: #0f172a;
  transition: width 0.2s linear, background-color 0.2s linear;
}
</style>

</body>
</html>
